import{_ as s,o as n,c as a,Q as e}from"./chunks/framework.0c8e00f4.js";const u=JSON.parse('{"title":"Browser Events","description":"","frontmatter":{},"headers":[],"relativePath":"reference/browser-events.md","filePath":"reference/browser-events.md"}'),o={name:"reference/browser-events.md"},l=e(`<h1 id="browser-events" tabindex="-1">Browser Events <a class="header-anchor" href="#browser-events" aria-label="Permalink to &quot;Browser Events&quot;">​</a></h1><p>Sometimes you may want to know when a payment has been made within the current browser tab. With the SDK, you can do this by listening to events on the element.</p><p>However, the use of <code>success</code> and <code>cancel</code> URLs is recommended as a fallback for when the browser events don&#39;t come through. See the <a href="#confirmation-urls">confirmation URLs</a> section.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>It is best practice to not rely on browser based events, as they can be tampered with or may not come through at all (eg: network outages). Instead, you can ask the Code Sequencer to notify you of events using a <a href="./../reference/webhook.html">webhook</a>.</p><p>Additionally, the <code>success</code> and <code>cancel</code> events may not be triggered on mobile devices. See <a href="./../intents/payment-requests.html#mobile-vs-desktop-flows">Payment Requests</a> for more information.</p></div><h2 id="how-it-works" tabindex="-1">How it works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How it works&quot;">​</a></h2><p>When you create an element, you can attach custom event handlers to it.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> code </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;https://js.getcode.com/v1&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">button</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> code.elements.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;button&#39;</span><span style="color:#E1E4E8;">, { </span><span style="color:#F97583;">...</span><span style="color:#E1E4E8;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">button.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;success&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">event</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// Handle successful payment, the intent ID will be provided in the event object</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// return true; // Return true to prevent the browser from navigating to the optional success URL provided in the confirmParams</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">button.</span><span style="color:#B392F0;">on</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;cancel&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">event</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// Handle cancelled payment, the intent ID will be provided in the event object</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// return true; // Return true to prevent the browser from navigating to the optional cancel URL provided in the confirmParams</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">button.</span><span style="color:#B392F0;">mount</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;#button-container&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> code </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;https://js.getcode.com/v1&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">button</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> code.elements.</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;button&#39;</span><span style="color:#24292E;">, { </span><span style="color:#D73A49;">...</span><span style="color:#24292E;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">button.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;success&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">event</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Handle successful payment, the intent ID will be provided in the event object</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// return true; // Return true to prevent the browser from navigating to the optional success URL provided in the confirmParams</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">button.</span><span style="color:#6F42C1;">on</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;cancel&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">event</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Handle cancelled payment, the intent ID will be provided in the event object</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// return true; // Return true to prevent the browser from navigating to the optional cancel URL provided in the confirmParams</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">button.</span><span style="color:#6F42C1;">mount</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;#button-container&#39;</span><span style="color:#24292E;">);</span></span></code></pre></div><h2 id="confirmation-urls" tabindex="-1">Confirmation URLs <a class="header-anchor" href="#confirmation-urls" aria-label="Permalink to &quot;Confirmation URLs&quot;">​</a></h2><p>In addition to event handlers, you can provide optional <code>success</code> and <code>cancel</code> URLs in the <code>confirmParams</code> object.</p><p>These URLs will be used to redirect the user to a success or cancel page once the payment has been made or cancelled. You can also use these URLs to gate content on your website. For example, you can redirect the user to a success page once the payment has been made.</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> code </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;https://js.getcode.com/v1&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">button</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> code.elements.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;button&#39;</span><span style="color:#E1E4E8;">, {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    confirmParams: {</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">        success: { url: </span><span style="color:#9ECBFF;">&#39;https://example.com/success/{{INTENT_ID}}&#39;</span><span style="color:#E1E4E8;">, },</span></span>
<span class="line highlighted"><span style="color:#E1E4E8;">        cancel: { url: </span><span style="color:#9ECBFF;">&#39;https://example.com/cancel&#39;</span><span style="color:#E1E4E8;">, },</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">button.</span><span style="color:#B392F0;">mount</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;#button-container&#39;</span><span style="color:#E1E4E8;">);</span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> code </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;https://js.getcode.com/v1&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">button</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> code.elements.</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;button&#39;</span><span style="color:#24292E;">, {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    confirmParams: {</span></span>
<span class="line highlighted"><span style="color:#24292E;">        success: { url: </span><span style="color:#032F62;">&#39;https://example.com/success/{{INTENT_ID}}&#39;</span><span style="color:#24292E;">, },</span></span>
<span class="line highlighted"><span style="color:#24292E;">        cancel: { url: </span><span style="color:#032F62;">&#39;https://example.com/cancel&#39;</span><span style="color:#24292E;">, },</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">button.</span><span style="color:#6F42C1;">mount</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;#button-container&#39;</span><span style="color:#24292E;">);</span></span></code></pre></div><p>Both the <code>success</code> and <code>cancel</code> urls can contain a special <code>INTENT_ID</code> variable, which will be automatically replaced with the intent ID once the payment has been made or cancelled. You can use this on your server to verify the intent status.</p><div class="info custom-block"><p class="custom-block-title">Note</p><p>These are optional but encouraged, especially on mobile devices where the <code>success</code> event may not be triggered. You can learn more about the differences between desktop and mobile flows on the <a href="./../intents/payment-requests.html#mobile-vs-desktop-flows">Payment Requests</a> page.</p></div><p>The full example code can be found on <a href="https://github.com/code-payments/code-sdk/tree/main/examples/4-minimal-with-webhook" target="_blank" rel="noreferrer">GitHub</a>.</p>`,14),t=[l];function p(c,r,i,y,E,d){return n(),a("div",null,t)}const m=s(o,[["render",p]]);export{u as __pageData,m as default};
